# ALCF Community Data Co-Op

## Share metadata using [ACDC Globus Portal](https://acdc.alcf.anl.gov/)

To share data and allow for data discovery and dissemination, we are using ACDC Globus portal. A user would need to go through the following steps in order to share data using the portal.

1. Move data to Eagle File System. If you are new to the ALCF, follow these instructions on [transferring data to eagle](transferring-data-to-eagle.md)

2. Create a Guest Collection (Only PI) to enable [data sharing](eagle-data-sharing.md#Creating a Guest Collection)

3. Generate metadata. The metadata has to follow [Globus Search API](https://docs.globus.org/api/search/ingest/#gmetaentry_subjects_and_entries) entries in order to be ingested by the portal. The list of mandatory and optional fields are defined in the API documentation page. We have created a [helper script](https://github.com/argonne-lcf/data-curator/blob/main/globus-data-curator.py) for generating metadata complying with Globus Search API. The helper script will parse through your entire project space and generate metadata. Feel free to modify the script as needed to generate the metadata you would like to publish. This script will generate a metadata.json file
```bash
wget -cO - https://raw.githubusercontent.com/argonne-lcf/data-curator/main/globus-data-curator.py?token=GHSAT0AAAAAAB7QNCRHTLBFJ74LIZQSE6S4ZA5L5OA > globus-data-curator.py 
python3 globus-data-curator.py -p <path_to_project> -n <Name of your project>
```
4. Once you have the metadata, you will need to create a "Globus Index". This can be done using [Globus Cli](https://docs.globus.org/cli/) on the login node.
```bash
module load conda
python3 -m venv ~/envs/globus-env #do this once
source ~/envs/globus-env/bin/activate
pip install globus-cli #do this once
globus search index create <name of project> <description>
```
5. The UUID for the index generated in the previous step is important. It can then be used to ingest the metadata
```bash
globus search ingest <index-UUID> metadata.json
```
You can use `globus search index list` to see all generated by you. Also `globus search index --help` will provide you various options. Please note there is a limit of 1.7MB of metadata that can be generated by a user for one index.

6. Finally, contact support@alcf.anl.gov with the following information,
   ```bash
    Please add the following index to the ACDC Globus Portal
    Project Name:
    Project Description: 
    Index UUID:
   ```
   The UUID will be added to the portal for others to view
